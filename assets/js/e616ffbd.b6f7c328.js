"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[5542],{3905:(M,e,t)=>{t.d(e,{Zo:()=>i,kt:()=>c});var n=t(67294);function D(M,e,t){return e in M?Object.defineProperty(M,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):M[e]=t,M}function w(M,e){var t=Object.keys(M);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(M);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(M,e).enumerable}))),t.push.apply(t,n)}return t}function a(M){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?w(Object(t),!0).forEach((function(e){D(M,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(M,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(e){Object.defineProperty(M,e,Object.getOwnPropertyDescriptor(t,e))}))}return M}function r(M,e){if(null==M)return{};var t,n,D=function(M,e){if(null==M)return{};var t,n,D={},w=Object.keys(M);for(n=0;n<w.length;n++)t=w[n],e.indexOf(t)>=0||(D[t]=M[t]);return D}(M,e);if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(M);for(n=0;n<w.length;n++)t=w[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(M,t)&&(D[t]=M[t])}return D}var A=n.createContext({}),N=function(M){var e=n.useContext(A),t=e;return M&&(t="function"==typeof M?M(e):a(a({},e),M)),t},i=function(M){var e=N(M.components);return n.createElement(A.Provider,{value:e},M.children)},l={inlineCode:"code",wrapper:function(M){var e=M.children;return n.createElement(n.Fragment,{},e)}},o=n.forwardRef((function(M,e){var t=M.components,D=M.mdxType,w=M.originalType,A=M.parentName,i=r(M,["components","mdxType","originalType","parentName"]),o=N(t),c=D,p=o["".concat(A,".").concat(c)]||o[c]||l[c]||w;return t?n.createElement(p,a(a({ref:e},i),{},{components:t})):n.createElement(p,a({ref:e},i))}));function c(M,e){var t=arguments,D=e&&e.mdxType;if("string"==typeof M||D){var w=t.length,a=new Array(w);a[0]=o;var r={};for(var A in e)hasOwnProperty.call(e,A)&&(r[A]=e[A]);r.originalType=M,r.mdxType="string"==typeof M?M:D,a[1]=r;for(var N=2;N<w;N++)a[N]=t[N];return n.createElement.apply(null,a)}return n.createElement.apply(null,t)}o.displayName="MDXCreateElement"},84561:(M,e,t)=>{t.r(e),t.d(e,{assets:()=>A,contentTitle:()=>a,default:()=>l,frontMatter:()=>w,metadata:()=>r,toc:()=>N});var n=t(87462),D=(t(67294),t(3905));const w={},a="\ud83e\udd77 OffSec CTF Writeup\u4f53\u9a8c",r={unversionedId:"Code/bluehens-ctf",id:"Code/bluehens-ctf",title:"\ud83e\udd77 OffSec CTF Writeup\u4f53\u9a8c",description:"\u56e0\u4e3a\u4e0a\u8bfe\u8981\u6c42\u8981\u6253\u4e00\u9053 CTF \u4ee5\u53ca\u5199\u4e00\u4e2a writeup, \u6240\u4ee5\u5728 ctftime \u9996\u9875\u4e0a\u770b\u4e86\u51e0\u4e2a\u6b63\u5728\u8fdb\u884c\u7684 CTF, \u770b\u5230\u8fd9\u4e2a\u91cc\u7684\u8fd9\u9053\u9898.",source:"@site/docs/Code/bluehens-ctf.md",sourceDirName:"Code",slug:"/Code/bluehens-ctf",permalink:"/docs/Code/bluehens-ctf",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud83e\udd35\ud83c\udffb\u200d\u2642\ufe0f React Web3\u4f18\u96c5\u7684\u767b\u5f55\u9a8c\u8bc1",permalink:"/docs/Code/auth"},next:{title:"\u260e\ufe0f \u6211\u7684\u4e00\u4e9b\u57df\u540d(Web2,Web3)",permalink:"/docs/Code/domain"}},A={},N=[{value:"\ud83d\udcdd \u9898\u76ee",id:"-\u9898\u76ee",level:2},{value:"\ud83e\uddd0 \u7b54\u6848",id:"-\u7b54\u6848",level:2},{value:"\ud83d\udea9 Flag",id:"-flag",level:2}],i={toc:N};function l(M){let{components:e,...w}=M;return(0,D.kt)("wrapper",(0,n.Z)({},i,w,{components:e,mdxType:"MDXLayout"}),(0,D.kt)("h1",{id:"-offsec-ctf-writeup\u4f53\u9a8c"},"\ud83e\udd77 OffSec CTF Writeup\u4f53\u9a8c"),(0,D.kt)("blockquote",null,(0,D.kt)("p",{parentName:"blockquote"},"\u56e0\u4e3a\u4e0a\u8bfe\u8981\u6c42\u8981\u6253\u4e00\u9053 CTF \u4ee5\u53ca\u5199\u4e00\u4e2a writeup, \u6240\u4ee5\u5728 ctftime \u9996\u9875\u4e0a\u770b\u4e86\u51e0\u4e2a\u6b63\u5728\u8fdb\u884c\u7684 CTF, \u770b\u5230",(0,D.kt)("a",{parentName:"p",href:"https://ctftime.org/event/1738"},"\u8fd9\u4e2a"),"\u91cc\u7684",(0,D.kt)("a",{parentName:"p",href:"https://bluehens.ctfd.io/challenges#Perhaps%20You%20Can-71"},"\u8fd9\u9053\u9898"),".")),(0,D.kt)("h2",{id:"-\u9898\u76ee"},"\ud83d\udcdd \u9898\u76ee"),(0,D.kt)("p",null,"Perhaps You Can"),(0,D.kt)("p",null,(0,D.kt)("inlineCode",{parentName:"p"},"550d0d0a00000000b7e8566370030000e300000000000000000000000000000000080000004000000073300200006500640083015a0165026501830164016b02731c650364028301010065046501a005a100830164036b02733465036402830101006501640464058502190064066b02734c650364028301010065016407190064086b027360650364028301010065066501640919008301640a1800650665016405190083016b02738465036402830101006501640b190065076508650965066501640c19008301830164046404640785031900830183016b0273b6650364028301010065066501640b19008301640d180065066501640d190083016b0273da650364028301010065066501640e190083015a0a65066501640f190083015a0b650a650b170064106b02900173086503640283010100650c650a650b830264116b0090017320650364028301010065016412641385021900a005a100a00da10064146b029001734265036402830101006501641319006501641519006b029001735c65036402830101006501641519006501641619006b029001737665036402830101006506650164171900830165066501641819008301140064196b029001739c650364028301010065066501641a1900830165066501641b19008301140065066501641c190083011400641d6b02900173ce6503640283010100650e641ea00f6510641f64208400650164216422850219008302a10183015a116511a012a1000100641ea00f6511a10164236b029002730e650364028301010065016424190064256b0290027324650364028301010065136426830101006404530029277a07696e7075743e20e926000000e90100000069d20d00004ee9060000007a0655444354467be9fffffffffa017de905000000e902000000e907000000e903000000e909000000e908000000e90a000000e9eb000000e977000000e90b000000e9180000005a1a3333356636323333363536653566363237393734373433333665e91b000000e91f000000e919000000e91a00000069522e0000e91c000000e91d000000e91e0000006960630900da0063010000000000000000000000010000000300000043000000730c000000740074017c0083018301530029014e2902da03737472da036f72642901da0178a900721c000000fa087472796d652e7079da083c6c616d6264613e20000000f300000000721e000000e920000000e9250000005a0e3030303131313131313132353537e922000000da01347a07596f752077696e2914da05696e707574da03746d70da036c656eda0465786974da0373756dda06656e636f6465721a000000da03636872da03696e747219000000721b000000da0179da036d6178da03686578da046c697374da046a6f696eda036d6170da027979da04736f7274da057072696e74721c000000721c000000721c000000721d000000da083c6d6f64756c653e01000000734a00000008010c01080110010801100108010c0108011c0108012a0108011c0108010c010c010e010801100108011a01080112010801120108011e0108012a01080120010801100108010e010801")),(0,D.kt)("h2",{id:"-\u7b54\u6848"},"\ud83e\uddd0 \u7b54\u6848"),(0,D.kt)("p",null,"\u62ff\u5230\u6570\u5b57\u540e, \u89c2\u5bdf\u5373\u53ef\u77e5\u9053, \u8fd9\u662f\u4e00\u4e2a\u5341\u516d\u8fdb\u5236\u7684\u5b57\u7b26\u4e32, \u4e8e\u662f\u653e\u5230 ",(0,D.kt)("a",{parentName:"p",href:"https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto')&input=NTUwZDBkMGEwMDAwMDAwMGI3ZTg1NjYzNzAwMzAwMDBlMzAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDgwMDAwMDA0MDAwMDAwMDczMzAwMjAwMDA2NTAwNjQwMDgzMDE1YTAxNjUwMjY1MDE4MzAxNjQwMTZiMDI3MzFjNjUwMzY0MDI4MzAxMDEwMDY1MDQ2NTAxYTAwNWExMDA4MzAxNjQwMzZiMDI3MzM0NjUwMzY0MDI4MzAxMDEwMDY1MDE2NDA0NjQwNTg1MDIxOTAwNjQwNjZiMDI3MzRjNjUwMzY0MDI4MzAxMDEwMDY1MDE2NDA3MTkwMDY0MDg2YjAyNzM2MDY1MDM2NDAyODMwMTAxMDA2NTA2NjUwMTY0MDkxOTAwODMwMTY0MGExODAwNjUwNjY1MDE2NDA1MTkwMDgzMDE2YjAyNzM4NDY1MDM2NDAyODMwMTAxMDA2NTAxNjQwYjE5MDA2NTA3NjUwODY1MDk2NTA2NjUwMTY0MGMxOTAwODMwMTgzMDE2NDA0NjQwNDY0MDc4NTAzMTkwMDgzMDE4MzAxNmIwMjczYjY2NTAzNjQwMjgzMDEwMTAwNjUwNjY1MDE2NDBiMTkwMDgzMDE2NDBkMTgwMDY1MDY2NTAxNjQwZDE5MDA4MzAxNmIwMjczZGE2NTAzNjQwMjgzMDEwMTAwNjUwNjY1MDE2NDBlMTkwMDgzMDE1YTBhNjUwNjY1MDE2NDBmMTkwMDgzMDE1YTBiNjUwYTY1MGIxNzAwNjQxMDZiMDI5MDAxNzMwODY1MDM2NDAyODMwMTAxMDA2NTBjNjUwYTY1MGI4MzAyNjQxMTZiMDA5MDAxNzMyMDY1MDM2NDAyODMwMTAxMDA2NTAxNjQxMjY0MTM4NTAyMTkwMGEwMDVhMTAwYTAwZGExMDA2NDE0NmIwMjkwMDE3MzQyNjUwMzY0MDI4MzAxMDEwMDY1MDE2NDEzMTkwMDY1MDE2NDE1MTkwMDZiMDI5MDAxNzM1YzY1MDM2NDAyODMwMTAxMDA2NTAxNjQxNTE5MDA2NTAxNjQxNjE5MDA2YjAyOTAwMTczNzY2NTAzNjQwMjgzMDEwMTAwNjUwNjY1MDE2NDE3MTkwMDgzMDE2NTA2NjUwMTY0MTgxOTAwODMwMTE0MDA2NDE5NmIwMjkwMDE3MzljNjUwMzY0MDI4MzAxMDEwMDY1MDY2NTAxNjQxYTE5MDA4MzAxNjUwNjY1MDE2NDFiMTkwMDgzMDExNDAwNjUwNjY1MDE2NDFjMTkwMDgzMDExNDAwNjQxZDZiMDI5MDAxNzNjZTY1MDM2NDAyODMwMTAxMDA2NTBlNjQxZWEwMGY2NTEwNjQxZjY0MjA4NDAwNjUwMTY0MjE2NDIyODUwMjE5MDA4MzAyYTEwMTgzMDE1YTExNjUxMWEwMTJhMTAwMDEwMDY0MWVhMDBmNjUxMWExMDE2NDIzNmIwMjkwMDI3MzBlNjUwMzY0MDI4MzAxMDEwMDY1MDE2NDI0MTkwMDY0MjU2YjAyOTAwMjczMjQ2NTAzNjQwMjgzMDEwMTAwNjUxMzY0MjY4MzAxMDEwMDY0MDQ1MzAwMjkyNzdhMDc2OTZlNzA3NTc0M2UyMGU5MjYwMDAwMDBlOTAxMDAwMDAwNjlkMjBkMDAwMDRlZTkwNjAwMDAwMDdhMDY1NTQ0NDM1NDQ2N2JlOWZmZmZmZmZmZmEwMTdkZTkwNTAwMDAwMGU5MDIwMDAwMDBlOTA3MDAwMDAwZTkwMzAwMDAwMGU5MDkwMDAwMDBlOTA4MDAwMDAwZTkwYTAwMDAwMGU5ZWIwMDAwMDBlOTc3MDAwMDAwZTkwYjAwMDAwMGU5MTgwMDAwMDA1YTFhMzMzMzM1NjYzNjMyMzMzMzM2MzUzNjY1MzU2NjM2MzIzNzM5MzczNDM3MzQzMzMzMzY2NWU5MWIwMDAwMDBlOTFmMDAwMDAwZTkxOTAwMDAwMGU5MWEwMDAwMDA2OTUyMmUwMDAwZTkxYzAwMDAwMGU5MWQwMDAwMDBlOTFlMDAwMDAwNjk2MDYzMDkwMGRhMDA2MzAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxMDAwMDAwMDMwMDAwMDA0MzAwMDAwMDczMGMwMDAwMDA3NDAwNzQwMTdjMDA4MzAxODMwMTUzMDAyOTAxNGUyOTAyZGEwMzczNzQ3MmRhMDM2ZjcyNjQyOTAxZGEwMTc4YTkwMDcyMWMwMDAwMDBmYTA4NzQ3Mjc5NmQ2NTJlNzA3OWRhMDgzYzZjNjE2ZDYyNjQ2MTNlMjAwMDAwMDBmMzAwMDAwMDAwNzIxZTAwMDAwMGU5MjAwMDAwMDBlOTI1MDAwMDAwNWEwZTMwMzAzMDMxMzEzMTMxMzEzMTMxMzIzNTM1MzdlOTIyMDAwMDAwZGEwMTM0N2EwNzU5NmY3NTIwNzc2OTZlMjkxNGRhMDU2OTZlNzA3NTc0ZGEwMzc0NmQ3MGRhMDM2YzY1NmVkYTA0NjU3ODY5NzRkYTAzNzM3NTZkZGEwNjY1NmU2MzZmNjQ2NTcyMWEwMDAwMDBkYTAzNjM2ODcyZGEwMzY5NmU3NDcyMTkwMDAwMDA3MjFiMDAwMDAwZGEwMTc5ZGEwMzZkNjE3OGRhMDM2ODY1NzhkYTA0NmM2OTczNzRkYTA0NmE2ZjY5NmVkYTAzNmQ2MTcwZGEwMjc5NzlkYTA0NzM2ZjcyNzRkYTA1NzA3MjY5NmU3NDcyMWMwMDAwMDA3MjFjMDAwMDAwNzIxYzAwMDAwMDcyMWQwMDAwMDBkYTA4M2M2ZDZmNjQ3NTZjNjUzZTAxMDAwMDAwNzM0YTAwMDAwMDA4MDEwYzAxMDgwMTEwMDEwODAxMTAwMTA4MDEwYzAxMDgwMTFjMDEwODAxMmEwMTA4MDExYzAxMDgwMTBjMDEwYzAxMGUwMTA4MDExMDAxMDgwMTFhMDEwODAxMTIwMTA4MDExMjAxMDgwMTFlMDEwODAxMmEwMTA4MDEyMDAxMDgwMTEwMDEwODAxMGUwMTA4MDE"},"CyberChef")," \u4e0a, \u9009\u62e9 ",(0,D.kt)("inlineCode",{parentName:"p"},"From Hex"),", \u5c1d\u8bd5\u83b7\u53d6\u66f4\u591a\u4fe1\u606f."),(0,D.kt)("p",null,"\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4ece ",(0,D.kt)("inlineCode",{parentName:"p"},"output")," \u4e2d\u770b\u5230\u5f88\u591a\u4ee3\u7801\u5173\u952e\u5b57, \u4f46\u662f\u6ca1\u6709\u529e\u6cd5\u786e\u5b9a\u662f\u4ec0\u4e48\u8bed\u8a00, \u53ef\u80fd\u5927\u6982\u7387\u662f ",(0,D.kt)("inlineCode",{parentName:"p"},"python"),"."),(0,D.kt)("p",null,(0,D.kt)("img",{src:t(44074).Z,width:"949",height:"457"})),(0,D.kt)("p",null,"\u4e4b\u540e\u6211\u4eec\u518d\u56de\u5230 ",(0,D.kt)("inlineCode",{parentName:"p"},"input")," \u4e2d, \u6765\u6572\u5b9a\u4ee3\u7801\u7684\u8bed\u8a00. \u6211\u4eec\u901a\u8fc7",(0,D.kt)("a",{parentName:"p",href:"https://book.hacktricks.xyz/generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/.pyc"},"\u641c\u7d22\u524d\u516d\u4f4d\u7684\u524d\u7f00 ",(0,D.kt)("inlineCode",{parentName:"a"},"550d0d0a")),", \u53ef\u4ee5\u4ece\u8fd9\u4e2a magic number \u4e2d\u77e5\u9053\u6587\u4ef6\u662f ",(0,D.kt)("inlineCode",{parentName:"p"},".pyc"),"."),(0,D.kt)("p",null,"\u7136\u540e\u6211\u4eec\u518d\u901a\u8fc7\u811a\u672c\u5c06 ",(0,D.kt)("inlineCode",{parentName:"p"},"hex string")," \u8f6c\u6362\u4e3a binary compiler pyc \u6587\u4ef6."),(0,D.kt)("pre",null,(0,D.kt)("code",{parentName:"pre",className:"language-py"},"import binascii\n\nhexString = \"550d0d0a......\"\nbinary = binascii.a2b_hex(c)\n\nfile = open('binary.pyc','wb')\nfile.write(binary)\n")),(0,D.kt)("p",null,"\u5f97\u5230 ",(0,D.kt)("inlineCode",{parentName:"p"},"binary.pyc")," \u7684\u6587\u4ef6\u540e, \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 ",(0,D.kt)("inlineCode",{parentName:"p"},"uncompyle6")," \u6216\u8005 ",(0,D.kt)("a",{parentName:"p",href:"https://www.toolnb.com/tools-lang-en/pyc.html"},(0,D.kt)("inlineCode",{parentName:"a"},"PyC decompiler"))," \u6765\u53cd\u7f16\u8bd1\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6, \u5f97\u5230 ",(0,D.kt)("inlineCode",{parentName:"p"},".py")," \u7684\u6e90\u7801."),(0,D.kt)("pre",null,(0,D.kt)("code",{parentName:"pre",className:"language-py"},"# uncompyle6 version 3.5.0\n# Python bytecode 3.8 (3413)\n# Decompiled from: Python 2.7.5 (default, Nov 16 2020, 22:23:17)\n# [GCC 4.8.5 20150623 (Red Hat 4.8.5-44)]\n# Embedded file name: tryme.py\n# Size of source mod 2**32: 880 bytes\ntmp = input('input> ')\nif not len(tmp) == 38:\n    exit(1)\nif not sum(tmp.encode()) == 3538:\n    exit(1)\nif not tmp[:6] == 'UDCTF{':\n    exit(1)\nif not tmp[(-1)] == '}':\n    exit(1)\nif not ord(tmp[5]) - 2 == ord(tmp[6]):\n    exit(1)\nif not tmp[7] == chr(int(str(ord(tmp[3]))[::-1])):\n    exit(1)\nif not ord(tmp[7]) - 9 == ord(tmp[9]):\n    exit(1)\nx = ord(tmp[8])\ny = ord(tmp[10])\nif not x + y == 235:\n    exit(1)\nif not max(x, y) < 119:\n    exit(1)\nif not tmp[11:24].encode().hex() == '335f6233656e5f62797474336e':\n    exit(1)\nif not tmp[24] == tmp[27]:\n    exit(1)\nif not tmp[27] == tmp[31]:\n    exit(1)\nif not ord(tmp[25]) * ord(tmp[26]) == 11858:\n    exit(1)\nif not ord(tmp[28]) * ord(tmp[29]) * ord(tmp[30]) == 615264:\n    exit(1)\nyy = list(''.join(map(lambda x: str(ord(x)), tmp[32:37])))\nyy.sort()\nif not ''.join(yy) == '00011111112557':\n    exit(1)\nif not tmp[34] == '4':\n    exit(1)\nprint('You win')\n")),(0,D.kt)("p",null,"\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u4ee3\u7801\u8fdb\u884c\u5206\u6790, \u5f97\u5230 flag:"),(0,D.kt)("ul",null,(0,D.kt)("li",{parentName:"ul"},'\u5bf9\u6bcf\u4e2a\u5224\u65ad\u8fdb\u884c\u9010\u6b65\u5206\u6790, "\u7ffb\u8bd1" \u4e3a ',(0,D.kt)("inlineCode",{parentName:"li"},"py")," \u4ee3\u7801, \u76f4\u63a5\u5f97\u5230\u5927\u90e8\u4efd\u7684 flag."),(0,D.kt)("li",{parentName:"ul"},"\u5bf9 flag \u7684\u8bed\u4e49\u8fdb\u884c\u731c\u6d4b, \u5982\u6700\u540e\u7684 ",(0,D.kt)("inlineCode",{parentName:"li"},"sn4ke"),", \u5728\u6700\u540e\u4e00\u4e2a\u5224\u65ad\u63ed\u793a\u4e2d\u95f4\u5b57\u7b26\u4e3a ",(0,D.kt)("inlineCode",{parentName:"li"},"4")," \u540e\u5c31\u53ef\u4ee5\u7ed3\u5408\u524d\u9762\u7684\u5185\u5bb9\u731c\u51fa\u8fd9\u4e2a\u8bcd.")),(0,D.kt)("pre",null,(0,D.kt)("code",{parentName:"pre",className:"language-py"},"import binascii\nflag = 'U D C T F {'.split() + ['*'] * (38 - 6)\nflag[6] = chr(ord(flag[5]) - 2)\nflag[7] = chr(int(str(ord(flag[3]))[::-1]))\nflag[9] = chr(ord(flag[7]) - 9)\nflag[-1] = '}'\nflag[34] = '4'\nflag[8] = 'u'\nflag[10] = 'v'\nflag_0 = str(binascii.a2b_hex('335f6233656e5f62797474336e'))[2:-1]\nflag_1 = ''.join(flag)[:11] + flag_0\nflag[25] = 'y'\nflag[26] = 'b'\nflag[28] = 't'\nflag[29] = 'f'\nflag[30] = 'h'\nflag_2 = '_'+'b'+'y'+'_'+'t'+'h'+'3' + '_'\nprint(flag_1 + flag_2 + 'sn4ke}')\n")),(0,D.kt)("h2",{id:"-flag"},"\ud83d\udea9 Flag"),(0,D.kt)("p",null,(0,D.kt)("inlineCode",{parentName:"p"},"UDCTF{y0u'v3_b3en_bytt3n_by_th3_sn4ke}")))}l.isMDXComponent=!0},44074:(M,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/hex-e69e60b86741808c3d917898bd015f2c.png"}}]);